<!DOCTYPE html>
<html>
<head>
    <title>A web map for viewing HydroShare data</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <link rel="stylesheet" href="hydroshare-leaflet-wms.css">
</head>
<body>
    <div class="header">
        <h1>Historical Voyage of Ibn Battuta in Asia</h1>
      </div>
      <div class="description">
        <p class="centered-text"> 
          Created by: Sujan Chandra Mondol <br/>
          Course : CE 514 - Geospatial Software Development <br/>
          Assignment number/name: A7 - A web map for viewing HydroShare data <br/>
          Date: 6 February, 2025 <br/>
        </p>
        <div class="container">
          <table class="tableframe">
            <tr>
              <th>What's Been Done</th>
            </tr>
            <tr>
              <td>After opening a HydroShare account, a  public <a href="https://hydroshare.org/resource/87e1889c6a4f4610b22fb7ce36bfd6fd/">resource</a> has been created to upload necessary files </td>
            </tr>
            <tr>
              <td>Shapefiles of one polygon, ten multilines, and eleven points has been uploaded.</td>
            </tr>
            <tr>
              <td>The polygon corresponds to the Continent Asia. The points denotes the places Ibn Battuta visited whereas the lines denotes the paths he used to reach those places.</td>
            </tr>
            <tr>
              <td>These shapefiles were added as layers in Leaflet to create the web map of the voyage. </td>
            </tr>
            <tr>
              <td>The map is interactive in a way that on the click of the user, the polygon is removed and points and lines are generated. </td>
            </tr>
            <tr>
              <td>The names of the places are not explicitly provided. Rather, they are generated by looping over the path names.  </td>
            </tr>
            <tr>
              <td>The JS and CSS are accessed from separate files.</td>
            </tr>
            
          </table>
        </div>
      </div>
    <button onclick="explorer()">Explore</button>
    <div id="forJS"></div>
    <div id="map" style="width: 80%; height: 500px;" class="center"></div>
    <script src="hydroshare-leaflet-wms.js"></script>
    <div>
        <h3 class="centered-text">JavaScript Code Used</h3>
            <code><pre>
var map = L.map('map').setView([34.0479,100.6197], 2.1); 

L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 19,
    attribution: '&amp;copy; &lt;a href="https://www.openstreetmap.org/copyright">OpenStreetMap&lt;/a> contributors'
}).addTo(map);

const asiaPolygon = L.tileLayer.wms('https://geoserver.hydroshare.org/geoserver/' + 
    'HS-87e1889c6a4f4610b22fb7ce36bfd6fd/wms', {
    layers: 'HS-87e1889c6a4f4610b22fb7ce36bfd6fd:Asia',
    format: 'image/png',
    transparent: true,
    attribution: 'Hydroshare GeoServer'
});
asiaPolygon.addTo(map);

var tracker = 1;

function explorer() {
    if (tracker==1) {
        map.removeLayer(asiaPolygon);
        const places = [];
        const paths = ["IstanbulToAstrakhan", "AstrakhanToSamarkand", "SamarkandToKabul", 
            "KabulToDelhi", "DelhiToCalicut", "CalicutToChittagong", "ChittagongToSingapore", 
            "SingaporeToQuanzhou", "QuanzhouToGuangzhou", "GuangzhouToBeijing"];
        for (let i=0; i&lt;=paths.length; i++) {
            const path = paths[i];
            const place = path.split("To")[0];
            places.push(place);
            const placeLayerName = 'HS-87e1889c6a4f4610b22fb7ce36bfd6fd:' + place;
            const placeLayer = L.tileLayer.wms('https://geoserver.hydroshare.org/geoserver/' + 
                'HS-87e1889c6a4f4610b22fb7ce36bfd6fd/wms', {
                layers: placeLayerName,
                format: 'image/png',
                transparent: true,
                attribution: 'Hydroshare GeoServer'
            });
            placeLayer.addTo(map);

            const pathLayerName = 'HS-87e1889c6a4f4610b22fb7ce36bfd6fd:' + path;
            const pathLayer = L.tileLayer.wms('https://geoserver.hydroshare.org/geoserver/' + 
                'HS-87e1889c6a4f4610b22fb7ce36bfd6fd/wms', {
                layers: pathLayerName,
                format: 'image/png',
                transparent: true,
                attribution: 'Hydroshare GeoServer'
            });

            pathLayer.addTo(map);

            if (i == paths.length){
                const place = path.split("To")[1];
                places.push(place);
                const placeLayerName = 'HS-87e1889c6a4f4610b22fb7ce36bfd6fd:' + place;
                const placeLayer = L.tileLayer.wms('https://geoserver.hydroshare.org/geoserver/' + 
                    'HS-87e1889c6a4f4610b22fb7ce36bfd6fd/wms', {
                    layers: placeLayerName,
                    format: 'image/png',
                    transparent: true,
                    attribution: 'Hydroshare GeoServer'
                });
                placeLayer.addTo(map);

            };
            document.getElementById('forJS').innerHTML = '<p><b>Paths: </b>' + paths + '<br/>' + '<b>Places:</b> ' + places + '</p>';
            
            
        };   
    };
    tracker += 1;
};
        
      </pre></code> </div>
      <div class="footer">
        Created by Sujan Chandra Mondol, 2025
      </div>

</body>
</html>